machine:
  xcode:
    version: "6.3.1"
  environment:
    XCODE_SCHEME: none
    XCODE_PROJECT: none

dependencies:
  pre:
    - brew install node
    - brew install caskroom/cask/brew-cask
    - brew cask install java
    - brew install android-sdk android-ndk ant
    - brew install ant
    - "echo 'y' | android update sdk --no-ui --force --all --filter platform-tools,android-19,build-tools-20.0.0"
    - npm install -g https://github.com/gameclosure/devkit-imagemin
    - npm install -g imagemin-pngquant
    - "if [ ! -d ~/swarm ]; then git clone --depth 1 --branch no-weeby https://github.com/weebygames/swarm ~/swarm; fi"
    - "if [ ! -d ~/devkit ]; then git clone https://github.com/gameclosure/devkit ~/devkit; fi"
    - "(cd ~/devkit && git pull && npm link)"
  cache_directories:
    - "~/swarm/"
    - "~/devkit/"

test:
  override:
    - mkdir -p ~/swarm/modules/
    - ln -s ~/devkit-core ~/swarm/modules/devkit-core
    - ./src/build/test/all-builds.sh ~/swarm
